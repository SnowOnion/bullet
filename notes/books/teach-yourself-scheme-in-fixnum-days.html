
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-FYHS50G6DL"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-FYHS50G6DL');
            
        </script>
    
    <title>Learning Scheme &#8212; 银色子弹</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/asciinema-player_2.6.1.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/asciinema-custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxnotes-strike.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster-custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/ablog.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.2/css/all.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/asciinema-player_2.6.1.js"></script>
    <script src="../../_static/translations.js"></script>
    <script data-isso="https://comments.silverrainz.me:30500" src="https://comments.silverrainz.me:30500/js/embed.min.js"></script>
    <link rel="canonical" href="https://silverrainz.me/notes/books/teach-yourself-scheme-in-fixnum-days.html" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="The Rust Programming Language" href="the-rust-programming-language.html" />
    <link rel="prev" title="向大师学绘画·素描基础" href="drawing-lessons-from-the-great-masters.html" /> 
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../../_static/logo.png" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../blog/atom.xml"
  title="银色子弹"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
             <section id="learning-scheme">
<h1>Learning Scheme<a class="headerlink" href="#learning-scheme" title="永久链接至标题">¶</a></h1>
<section id="id1">
<h2>教程<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://songjinghe.github.io/TYS-zh-translation/">Teach Yourself Scheme in Fixnum
Days.zh-CN</a></p></li>
<li><p><a class="reference external" href="http://deathking.github.io/yast-cn/index.html">Yet Another Scheme
Tutorial.zh-CN</a></p></li>
<li><p>The Little Schemer</p></li>
</ul>
</section>
<section id="id2">
<h2>编译器<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>guile 的自动补全</p></li>
</ul>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="c1">; pcaman -S readline</span>
<span class="c1">; ~/.guile</span>
<span class="p">(</span><span class="nf">use-modules</span> <span class="p">(</span><span class="nf">ice-9</span> <span class="nv">readline</span><span class="p">))</span>
<span class="p">(</span><span class="nf">activate-readline</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>chicken (csi) 的自动补全</p></li>
</ul>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="c1">; chicken-install readline</span>
<span class="c1">; ~/.csirc</span>
<span class="p">(</span><span class="nf">use</span> <span class="nv">readline</span><span class="p">)</span>
<span class="p">(</span><span class="nb">current-input-port </span><span class="p">(</span><span class="nf">make-readline-port</span><span class="p">))</span>
<span class="p">(</span><span class="nf">install-history-file</span> <span class="no">#f</span> <span class="s">&quot;/.csi.history&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2>正文<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>以下代码使用 chicken 运行。</p>
<section id="quote">
<h3>quote<a class="headerlink" href="#quote" title="永久链接至标题">¶</a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">quote</span></code> 用来阻止符号（symbol）被求值，<code class="code docutils literal notranslate"><span class="pre">'</span></code> 是其缩略形式:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>         <span class="k">=&gt; </span><span class="mi">3</span>
<span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">))</span> <span class="k">=&gt; </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&#39;</span><span class="p">(</span><span class="nv">+</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>        <span class="k">=&gt; </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&#39;</span><span class="p">()</span>             <span class="k">=&gt; </span><span class="p">()</span>
</pre></div>
</div>
<section id="id4">
<h4>特殊形式(?)<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h4>
<p>普通的 symbol 会对所以参数求值并返回值，特殊形式的 symbol
不会对所有的参数求值： <code class="code docutils literal notranslate"><span class="pre">qutoe</span></code>（这是当然的） <code class="code docutils literal notranslate"><span class="pre">lambda</span></code> <code class="code docutils literal notranslate"><span class="pre">define</span></code>
<code class="code docutils literal notranslate"><span class="pre">if</span></code> <code class="code docutils literal notranslate"><span class="pre">set!</span></code></p>
</section>
</section>
<section id="pair-list">
<h3>pair &amp; list<a class="headerlink" href="#pair-list" title="永久链接至标题">¶</a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">(cons</span> <span class="pre">1</span> <span class="pre">2)</span></code> 生成一个 pair <code class="code docutils literal notranslate"><span class="pre">(1</span> <span class="pre">.</span> <span class="pre">2)</span></code>，pair 的第一个元素被称为
car， 第二个元素被称为 cdr.</p>
<p>按照如下定义嵌套的 pair 被称为 list：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">'()</span></code> 是 list</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">(cons</span> <span class="pre">element</span> <span class="pre">list)</span></code> 是 list，element 可以是任意类型</p></li>
</ul>
<p>可以使用 <code class="code docutils literal notranslate"><span class="pre">(null?</span> <span class="pre">list)</span></code> 来判断表是否空（<code class="code docutils literal notranslate"><span class="pre">'()</span></code>）</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>                      <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">2</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">3</span> <span class="o">&#39;</span><span class="p">())))</span>  <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">2</span> <span class="mi">5</span><span class="p">))</span>             <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="o">.</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nb">cons </span><span class="sc">#\a</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">3</span> <span class="s">&quot;hello&quot;</span><span class="p">))</span>     <span class="k">=&gt; </span><span class="p">(</span><span class="sc">#\a</span> <span class="mi">3</span> <span class="o">.</span> <span class="s">&quot;hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="car-cdr-list">
<h4>car &amp; cdr &amp; list<a class="headerlink" href="#car-cdr-list" title="永久链接至标题">¶</a></h4>
<p>函数 <code class="code docutils literal notranslate"><span class="pre">car</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">cdr</span></code> 分别取回一个 pair 的 car 部分和 cdr 部分，
<code class="code docutils literal notranslate"><span class="pre">list</span></code> 用于构造一个表</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="c1">; pair</span>
<span class="p">(</span><span class="nb">car </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">2</span><span class="p">))</span>                          <span class="k">=&gt; </span><span class="mi">1</span>
<span class="p">(</span><span class="nb">cdr </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">2</span><span class="p">))</span>                          <span class="k">=&gt; </span><span class="mi">2</span>
<span class="c1">; list</span>
<span class="p">(</span><span class="nb">cdr </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="p">(</span><span class="mi">2</span> <span class="o">.</span> <span class="p">())))</span>                   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">2</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">3</span> <span class="o">&#39;</span><span class="p">()))))</span>    <span class="k">=&gt; </span><span class="p">(</span><span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="nb">list </span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>                            <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="mi">3</span><span class="p">))</span>            <span class="k">=&gt; </span><span class="p">((</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="atom">
<h4>atom<a class="headerlink" href="#atom" title="永久链接至标题">¶</a></h4>
<p>以下数据类型是 atom：</p>
<ul class="simple">
<li><p>numbers</p></li>
<li><p>strings</p></li>
<li><p>symbols</p></li>
<li><p>booleans</p></li>
<li><p>characters</p></li>
</ul>
<p>以下是 The Little Schemer 中对 atom 的定义：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="c1">; All that not a pair or null is an atom.</span>
<span class="c1">; define in The Little Schemer</span>
<span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</pre></div>
</div>
</section>
</section>
<section id="procedure">
<h3>procedure<a class="headerlink" href="#procedure" title="永久链接至标题">¶</a></h3>
<section id="lambda">
<h4>lambda<a class="headerlink" href="#lambda" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">lambda</span></code>，接受两个参数，返回一个
procedure，参数一是参数表，参数二是函数体：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nb">display </span><span class="s">&quot;archlinuxcn&quot;</span><span class="p">))</span>     <span class="k">=&gt; </span><span class="o">#</span><span class="nv">&lt;procedure</span> <span class="p">(</span><span class="nf">?</span><span class="p">)</span><span class="nv">&gt;</span>
<span class="p">((</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nb">display </span><span class="s">&quot;archlinuxcn&quot;</span><span class="p">)))</span>   <span class="k">=&gt; </span><span class="nv">archlinuxcn</span>
<span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>            <span class="k">=&gt; </span><span class="mi">3</span>
</pre></div>
</div>
</section>
<section id="define">
<h4>define<a class="headerlink" href="#define" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">define</span></code>
声明并绑定一个全局变量，参数一为变量名，参数二为被绑定的对象，
借此可以复用 <code class="code docutils literal notranslate"><span class="pre">lambda</span></code> 所生成的 procedure。</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="nv">add</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)))</span>
<span class="nv">add</span>         <span class="k">=&gt; </span><span class="o">#</span><span class="nv">&lt;procedure</span> <span class="p">(</span><span class="nf">add</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span><span class="nv">&gt;</span>
<span class="p">(</span><span class="nf">add</span> <span class="mi">1</span> <span class="mi">3</span><span class="p">)</span>   <span class="k">=&gt; </span><span class="mi">4</span>
<span class="p">(</span><span class="k">define </span><span class="nv">str</span> <span class="s">&quot;arch&quot;</span><span class="p">)</span>
<span class="nv">str</span>         <span class="k">=&gt; </span><span class="s">&quot;arch&quot;</span>
</pre></div>
</div>
</section>
<section id="id5">
<h4>不使用 lambda<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h4>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">add3</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="nv">add3</span>            <span class="k">=&gt; </span><span class="o">#</span><span class="nv">&lt;procedure</span> <span class="p">(</span><span class="nf">add3</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span><span class="nv">&gt;</span>
<span class="p">(</span><span class="nf">add3</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>    <span class="k">=&gt; </span><span class="mi">6</span>
</pre></div>
</div>
</section>
</section>
<section id="id6">
<h3>分支<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<section id="if">
<h4>if<a class="headerlink" href="#if" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">(if</span> <span class="pre">predicate</span> <span class="pre">then_value</span> <span class="pre">else_value)</span></code> 当 <code class="code docutils literal notranslate"><span class="pre">predicate</span></code> 为真则对
<code class="code docutils literal notranslate"><span class="pre">then_value</span></code> 求值， 反之则对 <code class="code docutils literal notranslate"><span class="pre">else_value</span></code> 求值，<code class="code docutils literal notranslate"><span class="pre">else_value</span></code>
部分可以省略，求得的值会传出括号外。 对于 <code class="code docutils literal notranslate"><span class="pre">predicate</span></code>，任意值（包括
<code class="code docutils literal notranslate"><span class="pre">#t</span></code>）被认为 ture，<code class="code docutils literal notranslate"><span class="pre">#f</span></code> 则是 false。</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nb">abs </span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span><span class="p">)</span>  <span class="nv">x</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="not-and-or">
<h4>not &amp; and &amp; or<a class="headerlink" href="#not-and-or" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">not</span></code> 接受一个参数，取反</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">and</span></code> 接受任意个参数，从左到右求值，若出现 <code class="code docutils literal notranslate"><span class="pre">#f</span></code> 则返回 <code class="code docutils literal notranslate"><span class="pre">#f</span></code>，
若全不为 <code class="code docutils literal notranslate"><span class="pre">#f</span></code> 则返回最后一个参数的值</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">and</span></code> 接受任意个参数，从左到右求值，返回第一个不是 <code class="code docutils literal notranslate"><span class="pre">#f</span></code> 的参数，
若全是 <code class="code docutils literal notranslate"><span class="pre">#f</span></code> 则返回最后一个参数的值</p></li>
</ul>
</section>
<section id="cond">
<h4>cond<a class="headerlink" href="#cond" title="永久链接至标题">¶</a></h4>
<p>类似 case：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">cond</span>
  <span class="p">(</span><span class="nf">predicate_1</span> <span class="nv">clauses_1</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">predicate_2</span> <span class="nv">clauses_2</span><span class="p">)</span>
    <span class="o">...</span>
  <span class="p">(</span><span class="nf">predicate_n</span> <span class="nv">clauses_n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">else </span>       <span class="nv">clauses_else</span><span class="p">))</span>
</pre></div>
</div>
<p>遇到成立的 <code class="code docutils literal notranslate"><span class="pre">predicate</span></code> 则执行对应的子句后返回，全部不成立则执行
<code class="code docutils literal notranslate"><span class="pre">else</span></code> 的子句。</p>
</section>
<section id="equ">
<h4>equ<a class="headerlink" href="#equ" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">=</span></code> 判断两个数字是否相等</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">eq?</span></code>
比较两个参数的地址，不要使用它来比较数字：其结果取决于编译器实现</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">eqv?</span></code> 是 <code class="code docutils literal notranslate"><span class="pre">eq</span></code> 的超集，对于原子类型（atom？）会进行正确的比较</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">equal?</span></code> 比较 list 与 vector</p></li>
</ul>
<p>ref:
<a class="reference external" href="http://stackoverflow.com/questions/16299246/what-is-the-difference-between-eq-eqv-equal-and-in-scheme">http://stackoverflow.com/questions/16299246/what-is-the-difference-between-eq-eqv-equal-and-in-scheme</a></p>
</section>
</section>
<section id="let">
<h3>let<a class="headerlink" href="#let" title="永久链接至标题">¶</a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">(let</span> <span class="pre">bind</span> <span class="pre">body)</span></code> 为 <code class="code docutils literal notranslate"><span class="pre">body</span></code> 语句绑定局部变量，变量在 <code class="code docutils literal notranslate"><span class="pre">bind</span></code>
中初始化， <code class="code docutils literal notranslate"><span class="pre">bind</span></code> 中的变量不可互相引用：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">i</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">i</span> <span class="mi">2</span><span class="p">))</span>   <span class="k">=&gt; </span><span class="mi">3</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">let</span></code> 是 <code class="code docutils literal notranslate"><span class="pre">lambda</span></code> 的语法糖：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">p</span> <span class="nv">v</span><span class="p">))</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">p</span> <span class="mi">1</span><span class="p">))</span>       <span class="k">=&gt; </span><span class="mi">2</span>
<span class="c1">; equal to</span>
<span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">p</span> <span class="mi">1</span><span class="p">))</span> <span class="nv">v</span><span class="p">)</span>    <span class="k">=&gt; </span><span class="mi">2</span>
</pre></div>
</div>
<section id="id7">
<h4>let*<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">let*</span></code> 可以引用定义在同个绑定中的变量（<code class="code docutils literal notranslate"><span class="pre">let*</span></code> 事实上是嵌套的
<code class="code docutils literal notranslate"><span class="pre">let</span></code> 的语法糖）：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">i</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">j</span> <span class="p">(</span><span class="nb">- </span><span class="nv">i</span><span class="p">)))</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">i</span> <span class="nv">j</span><span class="p">))</span>    <span class="k">=&gt; </span><span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="named-let">
<h4>named let<a class="headerlink" href="#named-let" title="永久链接至标题">¶</a></h4>
<p>可以为一个 <code class="code docutils literal notranslate"><span class="pre">let</span></code> 命名来实现循环：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fact-let</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="nv">loop</span><span class="p">((</span><span class="nf">n1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">p</span> <span class="nv">n</span><span class="p">))</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n1</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">p</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">m</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n1</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n1</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">p</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n1</span><span class="p">)))))))</span>
</pre></div>
</div>
</section>
<section id="letrec">
<h4>letrec<a class="headerlink" href="#letrec" title="永久链接至标题">¶</a></h4>
<p>允许 <code class="code docutils literal notranslate"><span class="pre">bind</span></code> 中的变量递归地调用自己：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sum-letrec</span> <span class="nv">xs</span><span class="p">)</span>
  <span class="p">(</span><span class="k">letrec </span><span class="p">((</span><span class="nf">sum1</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">xs1</span><span class="p">)</span>
                  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">xs1</span><span class="p">)</span> <span class="mi">0</span>
                    <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">xs1</span><span class="p">)</span> <span class="p">(</span><span class="nf">sum</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">xs1</span><span class="p">)))))))</span>
    <span class="p">(</span><span class="nf">sum1</span> <span class="nv">xs</span><span class="p">)))</span>
</pre></div>
</div>
</section>
</section>
<section id="do">
<h3>do<a class="headerlink" href="#do" title="永久链接至标题">¶</a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">(do</span> <span class="pre">binds</span> <span class="pre">(predicate</span> <span class="pre">value)</span> <span class="pre">body)</span></code> 变量在 <code class="code docutils literal notranslate"><span class="pre">bind</span></code> 中被绑定， 若
<code class="code docutils literal notranslate"><span class="pre">predicate</span></code> 为真， 则函数跳出 <code class="code docutils literal notranslate"><span class="pre">do</span></code> 语句，值 <code class="code docutils literal notranslate"><span class="pre">value</span></code> 被传递出来，
否则循环继续。 <code class="code docutils literal notranslate"><span class="pre">bind</span></code> 的形式是 <code class="code docutils literal notranslate"><span class="pre">((p</span> <span class="pre">i</span> <span class="pre">j)</span> <span class="pre">...</span> <span class="pre">)</span></code> 变量 <code class="code docutils literal notranslate"><span class="pre">p</span></code>
被初始化为 <code class="code docutils literal notranslate"><span class="pre">i</span></code>， 在循环后被更新为 <code class="code docutils literal notranslate"><span class="pre">j</span></code></p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fact-do</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">do </span><span class="p">((</span><span class="nf">n1</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n1</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">p</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">* </span><span class="nv">p</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n1</span> <span class="mi">1</span><span class="p">))))</span> <span class="p">((</span><span class="nb">= </span><span class="nv">n1</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">p</span><span class="p">)))</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3>递归<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">fact</span> <span class="n">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="o">=</span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span> <span class="p">(</span><span class="o">*</span> <span class="n">n</span> <span class="p">(</span><span class="n">fact</span> <span class="p">(</span><span class="o">-</span> <span class="n">n</span> <span class="mi">1</span><span class="p">)))))</span>
</pre></div>
</div>
<section id="id9">
<h4>尾递归<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h4>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fact-tail</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">fact-rec</span> <span class="nv">n</span> <span class="nv">n</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">fact-rec</span> <span class="nv">n</span> <span class="nv">p</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">p</span>
    <span class="p">(</span><span class="nf">fact-rec</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">p</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)))))</span>
<span class="c1">; 使用 named let 或者 letrec 的话可以不用两个函数</span>
</pre></div>
</div>
</section>
</section>
<section id="higher-order-function">
<h3>Higher Order Function<a class="headerlink" href="#higher-order-function" title="永久链接至标题">¶</a></h3>
<section id="map">
<h4>map<a class="headerlink" href="#map" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">(map</span> <span class="pre">procedure</span> <span class="pre">list1</span> <span class="pre">list2</span> <span class="pre">...)</span></code> <code class="code docutils literal notranslate"><span class="pre">map</span></code> 把 <code class="code docutils literal notranslate"><span class="pre">procedure</span></code>
应用到列表上， 返回新的列表，表的个数由 <code class="code docutils literal notranslate"><span class="pre">procedure</span></code> 决定</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">map </span><span class="nv">sub1</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span> <span class="k">=&gt; </span><span class="p">(</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="for-each">
<h4>for-each<a class="headerlink" href="#for-each" title="永久链接至标题">¶</a></h4>
<p>格式与 <code class="code docutils literal notranslate"><span class="pre">map</span></code> 相同，不返回具体的值，用于副作用：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="nv">sum</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="nb">for-each </span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">set! </span><span class="nv">sum</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">sum</span> <span class="nv">x</span><span class="p">)))</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">=&gt; </span><span class="mi">10</span>
<span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">set! </span><span class="nv">sum</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">sum</span> <span class="nv">x</span><span class="p">)))</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">=&gt; </span><span class="p">(</span><span class="o">#</span><span class="nv">&lt;unspecified&gt;</span> <span class="o">#</span><span class="nv">&lt;unspecified&gt;</span> <span class="o">#</span><span class="nv">&lt;unspecified&gt;</span> <span class="o">#</span><span class="nv">&lt;unspecified&gt;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fold">
<h4>fold<a class="headerlink" href="#fold" title="永久链接至标题">¶</a></h4>
<p>有左折叠（<code class="code docutils literal notranslate"><span class="pre">foldl</span></code>）和右折叠（<code class="code docutils literal notranslate"><span class="pre">foldr</span></code>）:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">foldl</span> <span class="nv">+</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>    <span class="k">=&gt; </span><span class="mi">6</span>
<span class="p">(</span><span class="nf">foldr</span> <span class="nv">+</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>    <span class="k">=&gt; </span><span class="mi">6</span>
</pre></div>
</div>
</section>
<section id="apply">
<h4>apply<a class="headerlink" href="#apply" title="永久链接至标题">¶</a></h4>
<p>将一个表展开作为过程的参数，接受任意多的参数，
第一个和最后一个参数分别应该是一个过程和一个列表（还不知道有什么用）：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">apply </span><span class="nv">+</span> <span class="mi">1</span> <span class="mi">2</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<section id="io">
<h5>IO<a class="headerlink" href="#io" title="永久链接至标题">¶</a></h5>
</section>
</section>
</section>
<section id="input">
<h3>input<a class="headerlink" href="#input" title="永久链接至标题">¶</a></h3>
<section id="port">
<h4>port<a class="headerlink" href="#port" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">(open-input-file</span> <span class="pre">file-name)</span></code> 用于打开一个文件返回一个端口，
<code class="code docutils literal notranslate"><span class="pre">(read-char</span> <span class="pre">port)</span></code> 从端口读取一个字符，读取到 EOF 的时候返回一个
<code class="code docutils literal notranslate"><span class="pre">eof-object</span></code>， 可用 <code class="code docutils literal notranslate"><span class="pre">eof-object?</span></code> 检查，使用
<code class="code docutils literal notranslate"><span class="pre">(close-input-port</span> <span class="pre">port)</span></code> 关闭端口</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">kitten</span> <span class="nv">fname</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">fp</span> <span class="p">(</span><span class="nb">open-input-file </span><span class="nv">fname</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">chr</span> <span class="p">(</span><span class="nb">read-char </span><span class="nv">fp</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eof-object? </span><span class="nv">chr</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">close-input-port </span><span class="nv">fp</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">begin</span>
          <span class="p">(</span><span class="nb">display </span><span class="nv">chr</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nb">read-char </span><span class="nv">fp</span><span class="p">)))))))</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">(call-with-input-file</span> <span class="pre">file-name</span> <span class="pre">procedure)</span></code> ： 函数将打开
<code class="code docutils literal notranslate"><span class="pre">file-name</span></code> 得到的端口传递给 <code class="code docutils literal notranslate"><span class="pre">procedure</span></code>， <code class="code docutils literal notranslate"><span class="pre">procedure</span></code>
结束后端口需要手动关闭</p>
<p><code class="code docutils literal notranslate"><span class="pre">(with-input-from-file</span> <span class="pre">file-name</span> <span class="pre">procedure)</span></code> ：
将文件作为标准输入打开，因此 <code class="code docutils literal notranslate"><span class="pre">procedure</span></code> 不需要参数， <code class="code docutils literal notranslate"><span class="pre">procedure</span></code>
结束后文件会自动被关闭</p>
</section>
<section id="read">
<h4>read<a class="headerlink" href="#read" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">(read</span> <span class="pre">port)</span></code> 从端口中读入一个 S-Expression（!）：</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">read-s</span> <span class="nv">fname</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">with-input-from-file </span><span class="nv">fname</span>
    <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
      <span class="p">(</span><span class="nf">begin</span>
        <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nf">read</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">newline</span><span class="p">)))))</span>
<span class="p">(</span><span class="nf">read-s</span> <span class="s">&quot;1.scm&quot;</span><span class="p">)</span>    <span class="k">=&gt; </span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">myabs</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">x</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="output">
<h3>output<a class="headerlink" href="#output" title="永久链接至标题">¶</a></h3>
<section id="id10">
<h4>port<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">(open-output-file</span> <span class="pre">file-name)</span></code>
打开一个文件，返回一个用于输出到该文件的端口</p>
<p><code class="code docutils literal notranslate"><span class="pre">(open-output-file</span> <span class="pre">file-name)</span></code> 关闭输出端口</p>
<p><code class="code docutils literal notranslate"><span class="pre">(call-with-output-file</span> <span class="pre">file-name</span> <span class="pre">procedure)</span></code></p>
<p><code class="code docutils literal notranslate"><span class="pre">(with-output-to-file</span> <span class="pre">file-name</span> <span class="pre">procedure)</span></code></p>
</section>
<section id="output-func">
<h4>output func<a class="headerlink" href="#output-func" title="永久链接至标题">¶</a></h4>
<p>以下函数的 <code class="code docutils literal notranslate"><span class="pre">port</span></code> 都是可选参数，省略则输出到 stdout</p>
<p><code class="code docutils literal notranslate"><span class="pre">(wirte</span> <span class="pre">obj</span> <span class="pre">port)</span></code> 将 <code class="code docutils literal notranslate"><span class="pre">obj</span></code> 输出至 <code class="code docutils literal notranslate"><span class="pre">port</span></code>，</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">write </span><span class="sc">#\c</span><span class="p">)</span>         <span class="k">=&gt; </span><span class="sc">#\c</span>
<span class="p">(</span><span class="nb">write </span><span class="s">&quot;string&quot;</span><span class="p">)</span>    <span class="k">=&gt; </span><span class="s">&quot;string&quot;</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">(display</span> <span class="pre">obj</span> <span class="pre">port)</span></code> 将 <code class="code docutils literal notranslate"><span class="pre">obj</span></code> 输出至 <code class="code docutils literal notranslate"><span class="pre">port</span></code>，</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">display </span><span class="sc">#\c</span><span class="p">)</span>         <span class="k">=&gt; </span><span class="nv">c</span>
<span class="p">(</span><span class="nb">display </span><span class="s">&quot;string&quot;</span><span class="p">)</span>    <span class="k">=&gt; </span><span class="nv">string</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">(wirte-char</span> <span class="pre">char</span> <span class="pre">port)</span></code> 往 <code class="code docutils literal notranslate"><span class="pre">port</span></code> 写入一个字符</p>
</section>
</section>
<section id="id11">
<h3>赋值<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>赋值具有破坏性（destructive）, Scheme 中具有破坏性的方法都以 <code class="code docutils literal notranslate"><span class="pre">!</span></code> 结尾</p>
<p><code class="code docutils literal notranslate"><span class="pre">(set!</span> <span class="pre">var</span> <span class="pre">val)</span></code> 为一个参数赋值，赋值前参数应该被定义</p>
<section id="lexical-closure">
<h4>词法闭包（lexical closure）<a class="headerlink" href="#lexical-closure" title="永久链接至标题">¶</a></h4>
<blockquote>
<div><p><em>WikiPedia:</em> 闭包又称词法闭包，是引用了自由变量的函数。
这个被引用的自由变量将和这个函数一同存在，即使已经离开了创造它的环境也不例外。
所以，有另一种说法认为闭包是由函数和与其相关的引用环境组合而成的实体。
闭包在运行时可以有多个实例，不同的引用环境和相同的函数组合可以产生不同的实例。</p>
</div></blockquote>
</section>
<section id="id12">
<h4>副作用<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h4>
<p>赋值 <code class="code docutils literal notranslate"><span class="pre">set!</span></code> 和 IO 操作都是副作用，</p>
</section>
<section id="id13">
<h4>表的赋值<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">set-car!</span></code> <code class="code docutils literal notranslate"><span class="pre">set-cdr!</span></code> 分别用于为表的 car 和 cdr 部分赋值，
参数可以是 S-Expression</p>
</section>
<section id="list">
<h4>用 list 实现一个队列<a class="headerlink" href="#list" title="永久链接至标题">¶</a></h4>
<p>list 的 car 部分储存了整个队列，cdr 部分储存了指向队列尾部的引用。</p>
<figure class="align-default" id="id14">
<img alt="structure of queue" src="../../_images/queue.png" />
<figcaption>
<p><span class="caption-text">structure of queue</span><a class="headerlink" href="#id14" title="永久链接至图片">¶</a></p>
</figcaption>
</figure>
<p><a class="reference external" href="http://www.shido.info/lisp/scheme_asg_e.html">图片出处</a></p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-queue</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cons </span><span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">()))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">enqueue!</span> <span class="nv">queue</span> <span class="nv">obj</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">lobj</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">obj</span> <span class="o">&#39;</span><span class="p">())))</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nb">car </span><span class="nv">queue</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">begin</span>
        <span class="c1">; lobj :: (1 . ()) :: (1)</span>
        <span class="c1">; queue :: (() . ()) :: (())</span>
      <span class="p">(</span><span class="nb">set-car! </span><span class="nv">queue</span> <span class="nv">lobj</span><span class="p">)</span>
        <span class="c1">; queue :: ((1 . ()) . ()) :: ((1))</span>
      <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">queue</span> <span class="nv">lobj</span><span class="p">))</span>
        <span class="c1">; queue ::  ((1 . ()) . (1 . ())) :: ((1) 1)</span>
        <span class="c1">; 此时队列的 car 和 cdr 部分都 *引用* 同一个对象 lobj</span>
    <span class="p">(</span><span class="nf">begin</span>
        <span class="c1">; lobj :: (2 . ()) :: (2)</span>
        <span class="c1">; queue ::  ((1 . ()) . (1 . ())) :: ((1) 1)</span>
      <span class="p">(</span><span class="nb">set-cdr! </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">queue</span><span class="p">)</span> <span class="nv">lobj</span><span class="p">)</span>
        <span class="c1">; queue ::  ((1 . (2 . ())) . (1 . (2 .()))) :: ((1 2) 1 2)</span>
        <span class="c1">; 借助 cdr 的引用将 lobj 入队</span>
      <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">queue</span> <span class="nv">lobj</span><span class="p">)))</span>
        <span class="c1">; queue ::  ((1 . (2 . ())) . (2 .())) :: ((1 2) 2)</span>
        <span class="c1">; 把 cdr 更新为当前的队尾 lobj</span>
    <span class="p">(</span><span class="nb">car </span><span class="nv">queue</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">dequeue!</span> <span class="nv">queue</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">obj</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">car </span><span class="nv">queue</span><span class="p">))))</span>
    <span class="p">(</span><span class="nb">set-car! </span><span class="nv">queue</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">car </span><span class="nv">queue</span><span class="p">)))</span>
    <span class="nv">obj</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">q</span> <span class="p">(</span><span class="nf">make-queue</span><span class="p">))</span>
<span class="p">(</span><span class="nf">enqueue!</span> <span class="nv">q</span> <span class="ss">&#39;a</span><span class="p">)</span>     <span class="k">=&gt; </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span>
<span class="p">(</span><span class="nf">enqueue!</span> <span class="nv">q</span> <span class="ss">&#39;b</span><span class="p">)</span>     <span class="k">=&gt; </span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span>
<span class="p">(</span><span class="nf">enqueue!</span> <span class="nv">q</span> <span class="ss">&#39;c</span><span class="p">)</span>     <span class="k">=&gt; </span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
<span class="p">(</span><span class="nf">dequeue!</span> <span class="nv">q</span><span class="p">)</span>        <span class="k">=&gt; </span><span class="nv">a</span>
<span class="nv">q</span>                   <span class="k">=&gt; </span><span class="p">((</span><span class="nf">b</span> <span class="nv">c</span><span class="p">)</span> <span class="nv">c</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此处有小坑，（尚未找到对此的规范描述，仅为自行总结）
不清楚 pair 中储存的到底是值还是引用，还是两者都有， 反正当 pair
中储存了 pair 时，用的是引用， 注意 <code class="code docutils literal notranslate"><span class="pre">set!</span></code>
更改的是这个变量名的指向， <code class="code docutils literal notranslate"><span class="pre">set-cdr!</span></code> 更改的是指向的对象内部的值
:(</p>
</div>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="c1">; 普通类型</span>
<span class="p">(</span><span class="k">define </span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="k">define </span><span class="nv">b</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="nv">a</span><span class="p">))</span>
<span class="nv">a</span>   <span class="k">=&gt; </span><span class="mi">1</span>
<span class="nv">b</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="k">set! </span><span class="nv">a</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">a</span>   <span class="k">=&gt; </span><span class="mi">2</span>
<span class="nv">b</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">.</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">; pair</span>
<span class="p">(</span><span class="k">define </span><span class="nv">a</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">2</span>  <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="k">define </span><span class="nv">b</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="nv">a</span><span class="p">))</span>
<span class="nv">a</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">2</span> <span class="o">.</span> <span class="mi">3</span><span class="p">)</span>
<span class="nv">b</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="o">.</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">a</span> <span class="mi">4</span><span class="p">)</span>
<span class="nv">a</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">2</span> <span class="o">.</span> <span class="mi">4</span><span class="p">)</span>
<span class="nv">b</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="o">.</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="k">set! </span><span class="nv">a</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
<span class="nv">b</span>   <span class="k">=&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="o">.</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="symbol">
<h2>Symbol<a class="headerlink" href="#symbol" title="永久链接至标题">¶</a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">(symbol?</span> <span class="pre">x)</span></code> 判断 <code class="code docutils literal notranslate"><span class="pre">x</span></code> 是否为一个符号，<code class="code docutils literal notranslate"><span class="pre">(string-&gt;symbol</span> <span class="pre">str)</span></code> 将
<code class="code docutils literal notranslate"><span class="pre">str</span></code> 转换为符号，<code class="code docutils literal notranslate"><span class="pre">(symbol-&gt;string</span> <span class="pre">sym)</span></code> 将 <code class="code docutils literal notranslate"><span class="pre">sym</span></code> 转化为字符串</p>
<div class="topic">
<p class="topic-title">评论</p>
<p>如果你有任何意见，请在此评论。
如果你留下了电子邮箱，我可能会通过 <script type="text/javascript">document.write(
    "<n pynff=\"ersrerapr rkgreany\" uers=\"znvygb:pbzzragf\100fvyireenvam\056zr\">pbzzragf\100fvyireenvam\056zr<\057n>".replace(/[a-zA-Z]/g,
        function(c){
            return String.fromCharCode(
                (c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26
            );
        }
    )
);</script> 回复你。</p>
<section data-isso-id="/notes/books/teach-yourself-scheme-in-fixnum-days" data-title="Learning Scheme" id="isso-thread"></section></div>
</section>
</section>

<div class="section">
   
</div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Yes silver bullet here.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=SilverRainZ&repo=bullet&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>导航</h3>
<p class="caption" role="heading"><span class="caption-text">笔记</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../zxsys/index.html">造型实验室</a></li>
<li class="toctree-l1"><a class="reference internal" href="../artstory/index.html">增量艺术史</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">读书笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../music-theory/index.html">乐理笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6-lectures-on-sketch.html">素描六讲</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2021-interview/index.html">2021 面试记录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docutils/index.html">Docutils 文档阅读</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go-internal/index.html">Golang Internal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leetcode/index.html">Leetcode 刷题记录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wizard/index.html">配置向导</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writeups/index.html">Capture the Flag</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">博客</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blog/index.html">博客首页</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">手册</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../man/sphinx/index.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/awk.html">Awk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/gdb.html">GDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/git.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/gpg.html">GnuPG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/grep.html">Grep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/irc.html">IRC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/krita.html">Krita</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/latex.html">LaTeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/lily.html">LilyPond</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/magick.html">ImageMagick</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/make.html">Makefile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/pacman.html">Pacman</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/py.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/rst.html">reStructuredText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/sh.html">Shell Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/vim.html">Vim</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">随记</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/2022/index.html">2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/2021/index.html">2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/2020/index.html">2020</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/2017/index.html">2017</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">收集室</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../collections/github-halloween.html">Github 万圣节彩蛋</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../collections/art-works/index.html">Art Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../collections/scores/index.html">乐谱夹</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">关于</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/me.html">我</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/site.html">本站</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/friends.html">友人帐</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/resume.html">简历</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">读书笔记</a><ul>
      <li>Previous: <a href="drawing-lessons-from-the-great-masters.html" title="上一章">向大师学绘画·素描基础</a></li>
      <li>Next: <a href="the-rust-programming-language.html" title="下一章">The Rust Programming Language</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020-2022, Shengyu Zhang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/notes/books/teach-yourself-scheme-in-fixnum-days.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/SilverRainZ/bullet" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>